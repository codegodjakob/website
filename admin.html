<!doctype html>
<html lang="de">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Admin</title>
    <link rel="icon" href="/favicon.ico?v=5" sizes="any" />
    <link rel="shortcut icon" href="/favicon.ico?v=5" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg?v=5" />
    <link rel="icon" type="image/png" href="/favicon-32x32.png?v=5" sizes="32x32" />
    <link rel="apple-touch-icon" href="/apple-touch-icon.png?v=5" />
    <link rel="mask-icon" href="/safari-pinned-tab.svg?v=5" color="#000000" />
    <link rel="manifest" href="/site.webmanifest?v=5" />
    <style>
      html.admin-locked body {
        visibility: hidden;
      }
      html.admin-ready body {
        visibility: visible;
      }
    </style>
    <script>
      document.documentElement.classList.add("admin-locked");
    </script>
    <link rel="stylesheet" href="admin.css" />
  </head>
  <body>
    <main class="panel">
      <header class="panel-header">
        <div>
          <h1>Admin</h1>
        </div>
        <div class="status-chips" role="status" aria-live="polite">
          <span id="status-text" class="status-chip">Gespeichert</span>
          <button id="save-btn" class="status-chip status-button" type="button">Speichern</button>
          <span id="count-text" class="status-chip">0 Einträge</span>
        </div>
        <div class="panel-actions">
          <button id="connect-live" type="button">Live verbinden</button>
          <button id="open-site" type="button">Zur Website</button>
          <button id="add-btn" type="button">Eintrag hinzufügen</button>
        </div>
      </header>

      <section id="sync-health" class="sync-health" aria-live="polite">
        <span id="sync-health-state" class="health-pill is-neutral">Live-Sync: Unbekannt</span>
        <span id="sync-health-pull" class="health-pill">Letzter Pull: -</span>
        <span id="sync-health-push" class="health-pill">Letzter Push: -</span>
        <span id="sync-health-endpoint" class="health-pill">API: /api/site-state</span>
        <p id="sync-health-error" class="health-error" hidden></p>
      </section>

      <details class="admin-panel category-panel">
        <summary>
          <div class="panel-summary">
            <h2>Kategorien</h2>
            <p>Diese Kategorien erscheinen als Label auf den Projektseiten.</p>
          </div>
        </summary>
        <div class="panel-body">
          <div class="category-controls">
            <input id="category-input" type="text" placeholder="Neue Kategorie" />
            <button id="add-category" type="button">Kategorie hinzufügen</button>
          </div>
          <div id="category-list" class="category-list"></div>
        </div>
      </details>

      <details class="admin-panel about-panel">
        <summary>
          <div class="panel-summary">
            <h2>About Seite</h2>
            <p>Inhalte für die About-Seite bearbeiten.</p>
          </div>
        </summary>
        <div class="panel-body">
          <div class="about-actions">
            <button id="about-edit" type="button">Inhalte bearbeiten</button>
            <button id="about-open" type="button">Seite öffnen</button>
          </div>
          <div class="about-grid">
            <label>
              Titel
              <input id="about-title" type="text" placeholder="Jakob Schlenker" />
            </label>
            <label>
              Inhalt
              <textarea id="about-body" rows="10" placeholder="Text für die About-Seite"></textarea>
            </label>
            <div class="about-image">
              <span class="label">Bild</span>
              <div id="about-image-preview" class="image-preview"></div>
              <div class="image-actions">
                <button id="about-upload" type="button">Upload</button>
                <button id="about-clear" type="button" class="delete">Entfernen</button>
              </div>
              <input id="about-file" type="file" accept="image/*" hidden />
            </div>
          </div>
        </div>
      </details>

      <details class="admin-panel contact-panel">
        <summary>
          <div class="panel-summary">
            <h2>Email</h2>
            <p>E-Mail-Adresse für die Dropdown-Links und die About-Seite.</p>
          </div>
        </summary>
        <div class="panel-body">
          <div class="contact-grid">
            <label>
              E-Mail
              <input id="contact-email" type="email" placeholder="hello@example.com" />
            </label>
          </div>
        </div>
      </details>

      <details class="admin-panel social-panel">
        <summary>
          <div class="panel-summary">
            <h2>Social Links</h2>
            <p>Spotify und LinkedIn Links prüfen und bearbeiten (nur Admin sichtbar).</p>
          </div>
        </summary>
        <div class="panel-body">
          <div class="social-grid">
            <div class="social-field">
              <label>
                Spotify URL
                <input id="social-spotify" type="url" placeholder="https://open.spotify.com/..." />
              </label>
              <span id="spotify-hint" class="social-hint"></span>
              <button id="check-spotify" type="button">Link prüfen</button>
            </div>
            <div class="social-field">
              <label>
                LinkedIn URL
                <input id="social-linkedin" type="url" placeholder="https://www.linkedin.com/..." />
              </label>
              <span id="linkedin-hint" class="social-hint"></span>
              <button id="check-linkedin" type="button">Link prüfen</button>
            </div>
          </div>
        </div>
      </details>

      <section class="list-header">
        <span>Sort</span>
        <span>Titel</span>
        <span>Kategorien</span>
        <span>Bild</span>
        <span>Aktion</span>
      </section>

      <section id="item-list" class="item-list"></section>

    </main>

    <div id="crop-modal" class="crop-modal" aria-hidden="true">
      <div class="crop-panel">
        <header class="crop-header">
          <div>
            <h2>Bild zuschneiden</h2>
            <p>Ziehe das Bild, um den Ausschnitt zu wählen.</p>
          </div>
          <button id="crop-close" type="button">Schließen</button>
        </header>
        <div class="crop-body">
          <div id="crop-frame" class="crop-frame">
            <img id="crop-image" alt="" />
          </div>
          <div class="crop-controls">
            <label>
              Zoom
              <input id="crop-zoom" type="range" min="1" max="2.5" step="0.01" value="1" />
            </label>
            <p id="crop-note" class="hint">Aspect Ratio 1.7:1 (wie die Bubble).</p>
            <div class="crop-actions">
              <button id="crop-cancel" type="button">Abbrechen</button>
              <button id="crop-apply" type="button">Crop anwenden</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script src="shared/constants.js"></script>
    <script src="shared/url.js"></script>
    <script src="shared/storage.js"></script>
    <script src="shared/sync-core.js"></script>
    <script src="state-sync.js"></script>
    <script src="admin-guard.js"></script>
  </body>
</html>
